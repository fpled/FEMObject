function v = subsref(H,s)

if size(s,2)==1 && strcmp(s(1).type,'.') %% H.F / H.alpha / H.dim / H.tree / H.var...
    switch s(1).subs
        case 'alpha'
            if length(s)==1
                v=H.alpha;
            else
                v=H.alpha(s(2).subs{:});
            end
        case 'F'

            if length(s)==1
                v=H.F;
            else
                v = subsref(H.F,s(2:end));
            end
        case 'dim'
            v = H.dim;
        case 'm'
            v = H.m;
        case 'tree'
            v = H.tree;
        case 'var'
            v= H.var;
    end

%%% Demande d'info par chemin : H.info{cible}(sequence des rangs)
elseif size(s,2)>1 && strcmp(s(1).type,'{}') && strcmp(s(2).type,'()')
    if strcmp(s(1).subs(1),'n')      %% La cible est un noeud, NUMERO DANS L'ARBRE
        node = s(1).subs(2);
        T=H.tree;
        var = get_var(T);
        var = {var{node{1}}(1)};
    elseif strcmp(s(1).subs(1),'v')  %% La cible est une variable
        var = s(1).subs(2);
    else error('Pas comprisla synthaxe');
    end % On connait la target
    
    % Pour lire les irank du type ([ 1 1 1 ]) au lieu de (1,1,1)
    if size(s(2).subs{1},2)>1 %% && size(s(2).subs,2)==1
        tmp = s(2).subs{1};
        nbtmp = size(tmp,2);
        s(2).subs = cell(1,nbtmp);
        for i=1:nbtmp
            s(2).subs{1,i}= tmp(i);
        end
    end
    
    
    %%% Trouver son chemin :
    Hscript = 'H';
    for cpt=1:size(s(2).subs,2)
        if eval(['~strcmp( class(' Hscript ') ,''SEPMATRIX'' )']) %% Ce n'est pas une sepmatrix
            subvar = eval([ Hscript '.subvar']);
            sortie=[];
            for subdim=1:size(subvar,1) %% Trouver la branche
                test = find(subvar{subdim}==var{1}, 1);
                if ~isempty(test)
                    sortie = subdim;
                    break
                end
            end %% Branche trouvée
            if size(sortie,1)==0 error('J''ai pas trouv� la variable demandee'); end
            subdim = sortie;

%%%%%% SI LE CPT DEPASSE LE RANG, IL FAUT RECREER PLEINS DE RANG
            if eval([Hscript '.m']) < s(2).subs{cpt} %% J'ai depasse comme un con...
                error('Tu depasses comme un con');
            end
%%%%%% C'EST BON, ON A TOUS LES RANGS NECESSAIRES !

            Hscript = [Hscript '.F{' num2str(s(2).subs{cpt}) ',' num2str(subdim) '}'];

        else %%% On est tombé sur une sepmatrix...
            subdim=find(subvar{subdim}==var{1});
            Hscript = [Hscript '.F{' num2str(s(2).subs{cpt}) ',' num2str(subdim) '}'];
        end

        
    end
    if size(s,2)==3
        %if ~strcmp(s(3).subs,'F') %% Si on ne demande pas F (alpha par exemple) :
        Hscript = [Hscript '.' s(3).subs ];
        %end
    end
    %%%% Chemin trouve (Hscript)
    %%%% On passe � l'action :
    v=eval(Hscript);

%%% Demander un alpha specifique : H(i,j)  -> cf SM
elseif size(s,2)==1 && strcmp(s(1).type,'()')
    if length(s.subs)==1
        v = H.F{s.subs{1}};
    elseif length(s.subs)==2
        v = H.F{s.subs{1}};
    end
    
    
end





